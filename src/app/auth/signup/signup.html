<div class="main-container">
    <form class="login" tuiAppearance="floating" tuiCardLarge tuiForm="m" [formGroup]="form">
        <header tuiHeader>
            <h2 tuiTitle>
                Registrieren
            </h2>
        </header>

        <!-- Vorname -->
        <tui-textfield tuiTextfieldSize="l">
            <label tuiLabel>Name</label>
            <input tuiTextfield formControlName="name" type="text" autocomplete="given-name" autocapitalize="words"
                spellcheck="false" />
        </tui-textfield>

        <!-- Geburtsdatum -->
        <tui-textfield tuiTextfieldSize="l">
            <label tuiLabel>Geburtsdatum</label>
            <input tuiInputDate formControlName="birthDate" autocomplete="bday" />
            <tui-calendar *tuiTextfieldDropdown />
        </tui-textfield>

        <!-- Telefonnummer -->
        <tui-textfield tuiTextfieldSize="l" [tuiTextfieldCleaner]="false">
            <label tuiLabel>Telefonnummer</label>
            <input tuiInputPhoneInternational [countries]="(countries | tuiSortCountries | async) || []"
                [countrySearch]="true" [(countryIsoCode)]="countryIsoCode" formControlName="phoneNumber"
                autocomplete="tel" />
        </tui-textfield>

        <!-- Email-Adresse -->
        <tui-textfield tuiTextfieldSize="l">
            <label tuiLabel>Email-Adresse</label>
            <input tuiTextfield formControlName="email" type="text" inputmode="email" autocomplete="email"
                autocapitalize="off" spellcheck="false" />
        </tui-textfield>

        <div class="passwords" formGroupName="passwords">
            <!-- Passwort -->
            <tui-textfield tuiTextfieldSize="l">
                <label tuiLabel>Kennwort</label>
                <input tuiTextfield formControlName="password" type="password" inputmode="text" autocapitalize="off"
                    autocomplete="new-password" spellcheck="false" />
                <tui-icon tuiPassword />
            </tui-textfield>

            <!-- Passwort bestätigen -->
            <tui-textfield tuiTextfieldSize="l">
                <label tuiLabel>Kennwort bestätigen</label>
                <input tuiTextfield formControlName="confirm" type="password" inputmode="text" autocapitalize="off"
                    spellcheck="false" autocomplete="new-password" />
                <tui-icon tuiPassword />
                @if (form.errors?.['passwordMismatch']) {
                <tui-error error="Passwörter stimmen nicht überein" />
                }
            </tui-textfield>
        </div>

        <!-- AGB Checkbox -->
        <label tuiLabel class="save-agb">
            <input formControlName="agb" tuiCheckbox type="checkbox" size="s" />
            <span> Ich habe die <button tuiLink type="button" (click)="showAGB()">
                    AGB
                </button> gelesen und akzeptiere sie.</span>
        </label>

        <footer>
            <button class="submit-button" tuiButton type="submit" (click)="onClick()" [disabled]="form.invalid">
                Registrieren
            </button>
        </footer>

        <div class="tui-space_top-4 flex items-center justify-between">
            <span>
                Ein Konto vorhanden?
                <button tuiLink type="button" tuiHintAppearance="dark" tuiHintDirection="top-left"
                    (click)="navigateToSignUp()">
                    Hier anmelden
                </button>
            </span>
        </div>

        <!-- Divider -->
        <div class="divider">
            <hr>
            <span>oder</span>
            <hr>
        </div>
        <!-- Google Button -->
        <div class="social-login">
            <button tuiButton type="button" appearance="outline"
                class="google-login flex items-center gap-2 px-4 py-2 rounded-lg shadow-sm border border-gray-300 hover:bg-gray-50"
                (click)="loginWithGoogle()">
                <img src="assets/google-logo.png.webp" alt="Google" class="google-logo" />
                Weiter mit Google
            </button>
        </div>
    </form>
    <ng-template #agbTemplate let-context>
        <div class="agb-content-container">
            <div class="agb-text">
                <app-agb-content></app-agb-content>
            </div>
            <button tuiButton type="button" (click)="context.complete()">
                Submit
            </button>
        </div>
    </ng-template>
</div>